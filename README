coming soon

BEFORE mangle

watch1
Chain PREROUTING (policy ACCEPT 57 packets, 12195 bytes)
 pkts bytes target     prot opt in     out     source               destination         
   57 12195 CONNMARK   all  --  *      *       0.0.0.0/0            0.0.0.0/0            CONNMARK restore
    0     0 NFQUEUE    all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x1 NFQUEUE num 0

Chain INPUT (policy ACCEPT 57 packets, 12195 bytes)
 pkts bytes target     prot opt in     out     source               destination         

Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MARK       all  --  *      tun0    172.17.0.0/16        0.0.0.0/0            MARK set 0x1
    0     0 CONNMARK   all  --  *      tun0    172.17.0.0/16        0.0.0.0/0            CONNMARK save

Chain OUTPUT (policy ACCEPT 60 packets, 12253 bytes)
 pkts bytes target     prot opt in     out     source               destination         

Chain POSTROUTING (policy ACCEPT 54 packets, 11848 bytes)
 pkts bytes target     prot opt in     out     source               destination         

AFTER

watch2
Chain PREROUTING (policy ACCEPT 96 packets, 21039 bytes)
 pkts bytes target     prot opt in     out     source               destination         
  106 21639 CONNMARK   all  --  *      *       0.0.0.0/0            0.0.0.0/0            CONNMARK restore
   10   600 NFQUEUE    all  --  *      *       0.0.0.0/0            0.0.0.0/0            mark match 0x1 NFQUEUE num 0

Chain INPUT (policy ACCEPT 95 packets, 20979 bytes)
 pkts bytes target     prot opt in     out     source               destination         

Chain FORWARD (policy ACCEPT 1 packets, 60 bytes)
 pkts bytes target     prot opt in     out     source               destination         
    1    60 MARK       all  --  *      tun0    172.17.0.0/16        0.0.0.0/0            MARK set 0x1
    1    60 CONNMARK   all  --  *      tun0    172.17.0.0/16        0.0.0.0/0            CONNMARK save

Chain OUTPUT (policy ACCEPT 102 packets, 18607 bytes)
 pkts bytes target     prot opt in     out     source               destination         

Chain POSTROUTING (policy ACCEPT 65 packets, 12950 bytes)
 pkts bytes target     prot opt in     out     source               destination         


BEFORE filter

filter1
Chain INPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination         

Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 DOCKER-USER  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
    0     0 DOCKER-FORWARD  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
    0     0 ACCEPT     all  --  tun0   docker0  0.0.0.0/0            0.0.0.0/0            ctstate RELATED,ESTABLISHED

Chain OUTPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination         
    6   405 NFQUEUE    tcp  --  *      *       172.31.43.219        0.0.0.0/0            match-set portfilter src ! match-set internal dst NFQUEUE num 0

Chain DOCKER (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 DROP       all  --  !docker0 docker0  0.0.0.0/0            0.0.0.0/0           

Chain DOCKER-BRIDGE (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 DOCKER     all  --  *      docker0  0.0.0.0/0            0.0.0.0/0           

Chain DOCKER-CT (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 ACCEPT     all  --  *      docker0  0.0.0.0/0            0.0.0.0/0            ctstate RELATED,ESTABLISHED

Chain DOCKER-FORWARD (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 DOCKER-CT  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
    0     0 DOCKER-ISOLATION-STAGE-1  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
    0     0 DOCKER-BRIDGE  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
    0     0 ACCEPT     all  --  docker0 *       0.0.0.0/0            0.0.0.0/0           

Chain DOCKER-ISOLATION-STAGE-1 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 DOCKER-ISOLATION-STAGE-2  all  --  docker0 !docker0  0.0.0.0/0            0.0.0.0/0           

Chain DOCKER-ISOLATION-STAGE-2 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 DROP       all  --  *      docker0  0.0.0.0/0            0.0.0.0/0           

Chain DOCKER-USER (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0           


AFTER

filter2
Chain INPUT (policy ACCEPT 38 packets, 8784 bytes)
 pkts bytes target     prot opt in     out     source               destination         

Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination         
    1    60 DOCKER-USER  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
    1    60 DOCKER-FORWARD  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
    0     0 ACCEPT     all  --  tun0   docker0  0.0.0.0/0            0.0.0.0/0            ctstate RELATED,ESTABLISHED

Chain OUTPUT (policy ACCEPT 10 packets, 1042 bytes)
 pkts bytes target     prot opt in     out     source               destination         
   38  5717 NFQUEUE    tcp  --  *      *       172.31.43.219        0.0.0.0/0            match-set portfilter src ! match-set internal dst NFQUEUE num 0

Chain DOCKER (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 DROP       all  --  !docker0 docker0  0.0.0.0/0            0.0.0.0/0           

Chain DOCKER-BRIDGE (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 DOCKER     all  --  *      docker0  0.0.0.0/0            0.0.0.0/0           

Chain DOCKER-CT (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 ACCEPT     all  --  *      docker0  0.0.0.0/0            0.0.0.0/0            ctstate RELATED,ESTABLISHED

Chain DOCKER-FORWARD (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    1    60 DOCKER-CT  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
    1    60 DOCKER-ISOLATION-STAGE-1  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
    1    60 DOCKER-BRIDGE  all  --  *      *       0.0.0.0/0            0.0.0.0/0           
    1    60 ACCEPT     all  --  docker0 *       0.0.0.0/0            0.0.0.0/0           

Chain DOCKER-ISOLATION-STAGE-1 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    1    60 DOCKER-ISOLATION-STAGE-2  all  --  docker0 !docker0  0.0.0.0/0            0.0.0.0/0           

Chain DOCKER-ISOLATION-STAGE-2 (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 DROP       all  --  *      docker0  0.0.0.0/0            0.0.0.0/0           

Chain DOCKER-USER (1 references)
 pkts bytes target     prot opt in     out     source               destination         
    1    60 RETURN     all  --  *      *       0.0.0.0/0            0.0.0.0/0           
